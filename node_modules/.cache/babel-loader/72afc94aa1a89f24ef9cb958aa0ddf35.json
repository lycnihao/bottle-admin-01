{"remainingRequest":"F:\\个人git项目\\couldr-user\\node_modules\\babel-loader\\lib\\index.js!F:\\个人git项目\\couldr-user\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\个人git项目\\couldr-user\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\个人git项目\\couldr-user\\src\\components\\Upload\\Upload.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\个人git项目\\couldr-user\\src\\components\\Upload\\Upload.vue","mtime":1583147575800},{"path":"F:\\个人git项目\\couldr-user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\个人git项目\\couldr-user\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\个人git项目\\couldr-user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\个人git项目\\couldr-user\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnVXBsb2FkJywKICBwcm9wczogewogICAgbmFtZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgZGVmYXVsdDogJ2ZpbGUnCiAgICB9LAogICAgbXVsdGlwbGU6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIGRyYWdnYWJsZTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCiAgICBhY2NlcHQ6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgIGRlZmF1bHQ6ICcnCiAgICB9LAogICAgdXBsb2FkSGFuZGxlcjogewogICAgICB0eXBlOiBGdW5jdGlvbiwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGhhbmRsZUNoYW5nZTogZnVuY3Rpb24gaGFuZGxlQ2hhbmdlKGluZm8pIHsKICAgICAgdGhpcy4kZW1pdCgnY2hhbmdlJywgaW5mbyk7CiAgICB9LAogICAgaGFuZGxlUmVtb3ZlOiBmdW5jdGlvbiBoYW5kbGVSZW1vdmUoZmlsZSkgewogICAgICB0aGlzLiRsb2cuZGVidWcoJ1JlbW92ZWQgZmlsZScsIGZpbGUpOwogICAgICB0aGlzLiRlbWl0KCdyZW1vdmUnLCBmaWxlKTsKICAgIH0sCiAgICBoYW5kbGVVcGxvYWQ6IGZ1bmN0aW9uIGhhbmRsZVVwbG9hZChvcHRpb24pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuJGxvZy5kZWJ1ZygnVXBsb2FkaW5nIG9wdGlvbicsIG9wdGlvbik7CiAgICAgIHZhciBDYW5jZWxUb2tlbiA9IGF4aW9zLkNhbmNlbFRva2VuOwogICAgICB2YXIgc291cmNlID0gQ2FuY2VsVG9rZW4uc291cmNlKCk7CiAgICAgIHZhciBkYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgIGRhdGEuYXBwZW5kKHRoaXMubmFtZSwgb3B0aW9uLmZpbGUpOwogICAgICB0aGlzLnVwbG9hZEhhbmRsZXIoZGF0YSwgZnVuY3Rpb24gKHByb2dyZXNzRXZlbnQpIHsKICAgICAgICBpZiAocHJvZ3Jlc3NFdmVudC50b3RhbCA+IDApIHsKICAgICAgICAgIHByb2dyZXNzRXZlbnQucGVyY2VudCA9IHByb2dyZXNzRXZlbnQubG9hZGVkIC8gcHJvZ3Jlc3NFdmVudC50b3RhbCAqIDEwMDsKICAgICAgICB9CgogICAgICAgIF90aGlzLiRsb2cuZGVidWcoJ1VwbG9hZGluZyBwZXJjZW50OiAnLCBwcm9ncmVzc0V2ZW50LnBlcmNlbnQpOwoKICAgICAgICBvcHRpb24ub25Qcm9ncmVzcyhwcm9ncmVzc0V2ZW50KTsKICAgICAgfSwgc291cmNlLnRva2VuLCBvcHRpb24uZmlsZSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpcy4kbG9nLmRlYnVnKCdVcGxvYWRlZCBzdWNjZXNzZnVsbHknLCByZXNwb25zZSk7CgogICAgICAgIG9wdGlvbi5vblN1Y2Nlc3MocmVzcG9uc2UsIG9wdGlvbi5maWxlKTsKCiAgICAgICAgX3RoaXMuJGVtaXQoJ3N1Y2Nlc3MnLCByZXNwb25zZSwgb3B0aW9uLmZpbGUpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBfdGhpcy4kbG9nLmRlYnVnKCdGYWlsZWQgdG8gdXBsb2FkIGZpbGUnLCBlcnJvcik7CgogICAgICAgIG9wdGlvbi5vbkVycm9yKGVycm9yLCBlcnJvci5yZXNwb25zZSk7CgogICAgICAgIF90aGlzLiRlbWl0KCdmYWlsdXJlJywgZXJyb3IsIG9wdGlvbi5maWxlKTsKICAgICAgfSk7CiAgICAgIHJldHVybiB7CiAgICAgICAgYWJvcnQ6IGZ1bmN0aW9uIGFib3J0KCkgewogICAgICAgICAgX3RoaXMuJGxvZy5kZWJ1ZygnVXBsb2FkIG9wZXJhdGlvbiBhYm9ydGVkIGJ5IHRoZSB1c2VyJyk7CgogICAgICAgICAgc291cmNlLmNhbmNlbCgnVXBsb2FkIG9wZXJhdGlvbiBjYW5jZWxlZCBieSB0aGUgdXNlci4nKTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["Upload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA,OAAA,KAAA,MAAA,OAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,QADA;AAEA,EAAA,KAAA,EAAA;AACA,IAAA,IAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,QAAA,EAAA,KAFA;AAGA,MAAA,OAAA,EAAA;AAHA,KADA;AAMA,IAAA,QAAA,EAAA;AACA,MAAA,IAAA,EAAA,OADA;AAEA,MAAA,QAAA,EAAA,KAFA;AAGA,MAAA,OAAA,EAAA;AAHA,KANA;AAWA,IAAA,SAAA,EAAA;AACA,MAAA,IAAA,EAAA,OADA;AAEA,MAAA,QAAA,EAAA,KAFA;AAGA,MAAA,OAAA,EAAA;AAHA,KAXA;AAgBA,IAAA,MAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,QAAA,EAAA,KAFA;AAGA,MAAA,OAAA,EAAA;AAHA,KAhBA;AAqBA,IAAA,aAAA,EAAA;AACA,MAAA,IAAA,EAAA,QADA;AAEA,MAAA,QAAA,EAAA;AAFA;AArBA,GAFA;AA4BA,EAAA,OAAA,EAAA;AACA,IAAA,YADA,wBACA,IADA,EACA;AACA,WAAA,KAAA,CAAA,QAAA,EAAA,IAAA;AACA,KAHA;AAIA,IAAA,YAJA,wBAIA,IAJA,EAIA;AACA,WAAA,IAAA,CAAA,KAAA,CAAA,cAAA,EAAA,IAAA;AACA,WAAA,KAAA,CAAA,QAAA,EAAA,IAAA;AACA,KAPA;AAQA,IAAA,YARA,wBAQA,MARA,EAQA;AAAA;;AACA,WAAA,IAAA,CAAA,KAAA,CAAA,kBAAA,EAAA,MAAA;AACA,UAAA,WAAA,GAAA,KAAA,CAAA,WAAA;AACA,UAAA,MAAA,GAAA,WAAA,CAAA,MAAA,EAAA;AAEA,UAAA,IAAA,GAAA,IAAA,QAAA,EAAA;AACA,MAAA,IAAA,CAAA,MAAA,CAAA,KAAA,IAAA,EAAA,MAAA,CAAA,IAAA;AAEA,WAAA,aAAA,CACA,IADA,EAEA,UAAA,aAAA,EAAA;AACA,YAAA,aAAA,CAAA,KAAA,GAAA,CAAA,EAAA;AACA,UAAA,aAAA,CAAA,OAAA,GAAA,aAAA,CAAA,MAAA,GAAA,aAAA,CAAA,KAAA,GAAA,GAAA;AACA;;AACA,QAAA,KAAA,CAAA,IAAA,CAAA,KAAA,CAAA,qBAAA,EAAA,aAAA,CAAA,OAAA;;AACA,QAAA,MAAA,CAAA,UAAA,CAAA,aAAA;AACA,OARA,EASA,MAAA,CAAA,KATA,EAUA,MAAA,CAAA,IAVA,EAYA,IAZA,CAYA,UAAA,QAAA,EAAA;AACA,QAAA,KAAA,CAAA,IAAA,CAAA,KAAA,CAAA,uBAAA,EAAA,QAAA;;AACA,QAAA,MAAA,CAAA,SAAA,CAAA,QAAA,EAAA,MAAA,CAAA,IAAA;;AACA,QAAA,KAAA,CAAA,KAAA,CAAA,SAAA,EAAA,QAAA,EAAA,MAAA,CAAA,IAAA;AACA,OAhBA,EAiBA,KAjBA,CAiBA,UAAA,KAAA,EAAA;AACA,QAAA,KAAA,CAAA,IAAA,CAAA,KAAA,CAAA,uBAAA,EAAA,KAAA;;AACA,QAAA,MAAA,CAAA,OAAA,CAAA,KAAA,EAAA,KAAA,CAAA,QAAA;;AACA,QAAA,KAAA,CAAA,KAAA,CAAA,SAAA,EAAA,KAAA,EAAA,MAAA,CAAA,IAAA;AACA,OArBA;AAsBA,aAAA;AACA,QAAA,KAAA,EAAA,iBAAA;AACA,UAAA,KAAA,CAAA,IAAA,CAAA,KAAA,CAAA,sCAAA;;AACA,UAAA,MAAA,CAAA,MAAA,CAAA,wCAAA;AACA;AAJA,OAAA;AAMA;AA5CA;AA5BA,CAAA","sourcesContent":["<template>\r\n  <div>\r\n    <a-upload-dragger\r\n      v-if=\"draggable\"\r\n      :name=\"name\"\r\n      :multiple=\"multiple\"\r\n      :accept=\"accept\"\r\n      :customRequest=\"handleUpload\"\r\n      :remove=\"handleRemove\"\r\n      @change=\"handleChange\"\r\n    >\r\n      <slot\r\n        role=\"button\"\r\n        class=\"ant-upload ant-upload-btn\"\r\n      />\r\n    </a-upload-dragger>\r\n    <a-upload\r\n      v-else\r\n      :name=\"name\"\r\n      :multiple=\"multiple\"\r\n      :accept=\"accept\"\r\n      :customRequest=\"handleUpload\"\r\n      :remove=\"handleRemove\"\r\n      @change=\"handleChange\"\r\n    >\r\n      <slot />\r\n    </a-upload>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n  name: 'Upload',\r\n  props: {\r\n    name: {\r\n      type: String,\r\n      required: false,\r\n      default: 'file'\r\n    },\r\n    multiple: {\r\n      type: Boolean,\r\n      required: false,\r\n      default: false\r\n    },\r\n    draggable: {\r\n      type: Boolean,\r\n      required: false,\r\n      default: true\r\n    },\r\n    accept: {\r\n      type: String,\r\n      required: false,\r\n      default: ''\r\n    },\r\n    uploadHandler: {\r\n      type: Function,\r\n      required: true\r\n    }\r\n  },\r\n  methods: {\r\n    handleChange(info) {\r\n      this.$emit('change', info)\r\n    },\r\n    handleRemove(file) {\r\n      this.$log.debug('Removed file', file)\r\n      this.$emit('remove', file)\r\n    },\r\n    handleUpload(option) {\r\n      this.$log.debug('Uploading option', option)\r\n      const CancelToken = axios.CancelToken\r\n      const source = CancelToken.source()\r\n\r\n      const data = new FormData()\r\n      data.append(this.name, option.file)\r\n\r\n      this.uploadHandler(\r\n        data,\r\n        progressEvent => {\r\n          if (progressEvent.total > 0) {\r\n            progressEvent.percent = (progressEvent.loaded / progressEvent.total) * 100\r\n          }\r\n          this.$log.debug('Uploading percent: ', progressEvent.percent)\r\n          option.onProgress(progressEvent)\r\n        },\r\n        source.token,\r\n        option.file\r\n      )\r\n        .then(response => {\r\n          this.$log.debug('Uploaded successfully', response)\r\n          option.onSuccess(response, option.file)\r\n          this.$emit('success', response, option.file)\r\n        })\r\n        .catch(error => {\r\n          this.$log.debug('Failed to upload file', error)\r\n          option.onError(error, error.response)\r\n          this.$emit('failure', error, option.file)\r\n        })\r\n      return {\r\n        abort: () => {\r\n          this.$log.debug('Upload operation aborted by the user')\r\n          source.cancel('Upload operation canceled by the user.')\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n</style>\r\n"],"sourceRoot":"src/components/Upload"}]}